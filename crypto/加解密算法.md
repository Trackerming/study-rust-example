**### 基础概念

#### 数学原理

#### 对称加密

##### DES

> 数据加密标准，主要过程的重点在轮函数的处理和轮子密钥的生成

- 子密钥的生成过程
    - 64bit的key，实际有效位为56bit
- 轮函数的处理
    - 初始明文的置换 64bit，然后分为L和R
    - 对R
        - E扩展：32 bit -> 48 bit （R1）
        - 与密钥异或：R1 & Key_i （R2）
        - S盒子：48 bit -> 32 bit （R3）
            - b1和b6代表行，b2到b4代表列
            - 获取到的数字用二进制表示
        - P盒变换：(R4)
        - L与计算得到的R4异或得到这一轮的R
    - 上一轮的R变为L，然后输入去计算R

###### 3DES

##### AES

#### 非对称加密

##### RSA

##### ECC

> 椭圆曲线的公式

```
$y^2 = x^3 + a*x + b$
```

- 有限域
- 阶
- G
- 逆元
- a和b

###### 加解密

> 公钥可以用来加密数据，拥有对应私钥的能解密出原始的消息M

- 公钥加密
    - m：消息
    - d：私钥，公钥Q = d*G
    - k: 随机数

    ```
    C1 = m+k*Q
    C2 = k*G
    ```

> 上述过程求解k是一个困难问题，下述过程由于知道d，所以可以结合C2得到k*Q，消除这部分就可以解密出来数据

- 私钥解密
    - 解密过程如下

      ```
      C1 = m+k*Q = m+k*d*G = m+d*k*G
         = m+d*C2
      ```

###### 签名验签

- 私钥签名
    - m：消息
    - d：私钥，公钥Q = d*G
    - k: 随机数
    - r: k*G的x（横坐标）
    - H: m的hash值

    ```
    R = k*G = (x, y)
    s = k^-1 * (H+d*r) mod n
    ```

- 公钥验签
    - 验证方收到m，K，和s， R

    ```
    s^(-1) * H *G + s^(-1) * r * Q = kG
    ```

    - 推导过程如下

    ```
    s^(-1) * H*G + s^(-1) *r*Q = s^(-1) *(H*G + r*d*G)
     = k/(H + d*r) *(H*G + r*d*G)
     = (k*H*G + k*r*d*G)/(H + d*r)
     = (k*G(H + r*d))(H + d*r)
     = k*G
    ```
